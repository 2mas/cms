{"version":3,"sources":["matrix/src/MatrixInput.js"],"names":["$","Craft","MatrixInput","Garnish","Base","extend","blockTypes","blockTypesByHandle","inputNamePrefix","showingAddBlockMenu","addBlockBtnGroupWidth","addBlockBtnContainerWidth","$blockContainer","$addBlockBtnContainer","$addBlockBtnGroup","$addBlockBtnGroupBtns","blockSort","totalNewBlocks","blockSelect","id","settings","i","collapsedBlocks","inputIdPrefix","this","formatInputId","maxBlocks","$container","setSettings","defaults","children","$addBlockMenuBtn","setNewBlockBtn","data","handle","getCollapsedBlockIds","blockType","DragSort","$blocks","$targetItem","hasClass","axis","filter","proxy","getSelectedItems","resetItemOrder","Select","magnetStrength","helperLagBase","helperOpacity","onSortChange","blockId","multi","vertical","checkboxMode","length","MatrixBlock","$block","newMatch","match","block","inArray","option","collapse","updateAddBlockBtn","ev","addListener","type","ready","MenuBtn","addBlock","width","requestAnimationFrame","addClass","removeClass","navigator","userAgent","indexOf","css","$items","canAddMoreBlocks","$actionMenu","eq","find","parent","getBlockTypeByHandle","$insertBefore","html","name","t","staticBlocks","$fieldsContainer","appendTo","getParsedBlockHtml","addItems","bodyHtml","footHtml","trigger","getHiddenBlockCss","velocity","expandSelectedBlocks","callOnSelectedBlocks","disableSelectedBlocks","append","initUiElements","enableSelectedBlocks","deleteSelectedBlocks","first","collapseSelectedBlocks","localStorage","collapsedBlockStorageKey","$selectedItems","rememberCollapsedBlockId","fn","setCollapsedBlockIds","marginBottom","outerHeight","collapsedBlocksIndex","replace","splice","$titlebar","$previewContainer","systemUid","collapsed","filterArray","split","isNew","$menuBtn","ids","join","menuBtn","onOptionSelect","menu","Storage","push","forgetCollapsedBlockId","_handleTitleBarClick","preventDefault","matrix","previewHtml","$fields","$field","inputPreviewText","init","$input","$inputs","value","$maybeLightswitchContainer","substr","getText","getInputPostVal","on","hasAttr","expand","animate","$collapsedInput","j","val","text","Array","show","hide","duration","height","setTimeout","onMenuOptionSelect","$option","collapsedContainerHeight","expandedContainerHeight","displayValue","batchAction","display","disable","confirm","enable","selfDestruct","totalSelected","isSelected","draftEditor","checkForm","remove","window","jQuery"],"mappings":"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","file":"MatrixInput.min.js","sourcesContent":["(function($) {\n    /** global: Craft */\n    /** global: Garnish */\n    /**\n     * Matrix input class\n     */\n    Craft.MatrixInput = Garnish.Base.extend(\n        {\n            id: null,\n            blockTypes: null,\n            blockTypesByHandle: null,\n            inputNamePrefix: null,\n            inputIdPrefix: null,\n\n            showingAddBlockMenu: false,\n            addBlockBtnGroupWidth: null,\n            addBlockBtnContainerWidth: null,\n\n            $container: null,\n            $blockContainer: null,\n            $addBlockBtnContainer: null,\n            $addBlockBtnGroup: null,\n            $addBlockBtnGroupBtns: null,\n\n            blockSort: null,\n            blockSelect: null,\n            totalNewBlocks: 0,\n\n            init: function(id, blockTypes, inputNamePrefix, settings) {\n                this.id = id;\n                this.blockTypes = blockTypes;\n                this.inputNamePrefix = inputNamePrefix;\n                this.inputIdPrefix = Craft.formatInputId(this.inputNamePrefix);\n\n                // see if settings was actually set to the maxBlocks value\n                if (typeof settings === 'number') {\n                    settings = {maxBlocks: settings};\n                }\n                this.setSettings(settings, Craft.MatrixInput.defaults);\n\n                this.$container = $('#' + this.id);\n                this.$blockContainer = this.$container.children('.blocks');\n                this.$addBlockBtnContainer = this.$container.children('.buttons');\n                this.$addBlockBtnGroup = this.$addBlockBtnContainer.children('.btngroup');\n                this.$addBlockBtnGroupBtns = this.$addBlockBtnGroup.children('.btn');\n                this.$addBlockMenuBtn = this.$addBlockBtnContainer.children('.menubtn');\n\n                this.$container.data('matrix', this);\n\n                this.setNewBlockBtn();\n\n                this.blockTypesByHandle = {};\n\n                var i;\n\n                for (i = 0; i < this.blockTypes.length; i++) {\n                    var blockType = this.blockTypes[i];\n                    this.blockTypesByHandle[blockType.handle] = blockType;\n                }\n\n                var $blocks = this.$blockContainer.children(),\n                    collapsedBlocks = Craft.MatrixInput.getCollapsedBlockIds();\n\n                this.blockSort = new Garnish.DragSort($blocks, {\n                    handle: '> .actions > .move',\n                    axis: 'y',\n                    filter: $.proxy(function() {\n                        // Only return all the selected items if the target item is selected\n                        if (this.blockSort.$targetItem.hasClass('sel')) {\n                            return this.blockSelect.getSelectedItems();\n                        }\n                        else {\n                            return this.blockSort.$targetItem;\n                        }\n                    }, this),\n                    collapseDraggees: true,\n                    magnetStrength: 4,\n                    helperLagBase: 1.5,\n                    helperOpacity: 0.9,\n                    onSortChange: $.proxy(function() {\n                        this.blockSelect.resetItemOrder();\n                    }, this)\n                });\n\n                this.blockSelect = new Garnish.Select(this.$blockContainer, $blocks, {\n                    multi: true,\n                    vertical: true,\n                    handle: '> .checkbox, > .titlebar',\n                    checkboxMode: true\n                });\n\n                for (i = 0; i < $blocks.length; i++) {\n                    var $block = $($blocks[i]),\n                        blockId = $block.data('id');\n\n                    // Is this a new block?\n                    var newMatch = (typeof blockId === 'string' && blockId.match(/new(\\d+)/));\n\n                    if (newMatch && newMatch[1] > this.totalNewBlocks) {\n                        this.totalNewBlocks = parseInt(newMatch[1]);\n                    }\n\n                    var block = new MatrixBlock(this, $block);\n\n                    if (block.id && $.inArray('' + block.id, collapsedBlocks) !== -1) {\n                        block.collapse();\n                    }\n                }\n\n                this.addListener(this.$addBlockBtnGroupBtns, 'click', function(ev) {\n                    var type = $(ev.target).data('type');\n                    this.addBlock(type);\n                });\n\n                new Garnish.MenuBtn(this.$addBlockMenuBtn,\n                    {\n                        onOptionSelect: $.proxy(function(option) {\n                            var type = $(option).data('type');\n                            this.addBlock(type);\n                        }, this)\n                    });\n\n                this.updateAddBlockBtn();\n\n                this.addListener(this.$container, 'resize', 'setNewBlockBtn');\n                Garnish.$doc.ready($.proxy(this, 'setNewBlockBtn'));\n\n                this.trigger('afterInit');\n            },\n\n            setNewBlockBtn: function() {\n                // Do we know what the button group width is yet?\n                if (!this.addBlockBtnGroupWidth) {\n                    this.addBlockBtnGroupWidth = this.$addBlockBtnGroup.width();\n\n                    if (!this.addBlockBtnGroupWidth) {\n                        return;\n                    }\n                }\n\n                // Only check if the container width has resized\n                if (this.addBlockBtnContainerWidth !== (this.addBlockBtnContainerWidth = this.$addBlockBtnContainer.width())) {\n                    if (this.addBlockBtnGroupWidth > this.addBlockBtnContainerWidth) {\n                        if (!this.showingAddBlockMenu) {\n                            this.$addBlockBtnGroup.addClass('hidden');\n                            this.$addBlockMenuBtn.removeClass('hidden');\n                            this.showingAddBlockMenu = true;\n                        }\n                    }\n                    else {\n                        if (this.showingAddBlockMenu) {\n                            this.$addBlockMenuBtn.addClass('hidden');\n                            this.$addBlockBtnGroup.removeClass('hidden');\n                            this.showingAddBlockMenu = false;\n\n                            // Because Safari is awesome\n                            if (navigator.userAgent.indexOf('Safari') !== -1) {\n                                Garnish.requestAnimationFrame($.proxy(function() {\n                                    this.$addBlockBtnGroup.css('opacity', 0.99);\n\n                                    Garnish.requestAnimationFrame($.proxy(function() {\n                                        this.$addBlockBtnGroup.css('opacity', '');\n                                    }, this));\n                                }, this));\n                            }\n                        }\n                    }\n                }\n            },\n\n            canAddMoreBlocks: function() {\n                return (!this.maxBlocks || this.$blockContainer.children().length < this.maxBlocks);\n            },\n\n            updateAddBlockBtn: function() {\n                var i, block;\n\n                if (this.canAddMoreBlocks()) {\n                    this.$addBlockBtnGroup.removeClass('disabled');\n                    this.$addBlockMenuBtn.removeClass('disabled');\n\n                    for (i = 0; i < this.blockSelect.$items.length; i++) {\n                        block = this.blockSelect.$items.eq(i).data('block');\n\n                        if (block) {\n                            block.$actionMenu.find('a[data-action=add]').parent().removeClass('disabled');\n                        }\n                    }\n                }\n                else {\n                    this.$addBlockBtnGroup.addClass('disabled');\n                    this.$addBlockMenuBtn.addClass('disabled');\n\n                    for (i = 0; i < this.blockSelect.$items.length; i++) {\n                        block = this.blockSelect.$items.eq(i).data('block');\n\n                        if (block) {\n                            block.$actionMenu.find('a[data-action=add]').parent().addClass('disabled');\n                        }\n                    }\n                }\n            },\n\n            addBlock: function(type, $insertBefore) {\n                if (!this.canAddMoreBlocks()) {\n                    return;\n                }\n\n                this.totalNewBlocks++;\n\n                var id = 'new' + this.totalNewBlocks;\n\n                var html = `\n<div class=\"matrixblock\" data-id=\"${id}\" data-type=\"${type}\">\n  <input type=\"hidden\" name=\"${this.inputNamePrefix}[sortOrder][]\" value=\"${id}\"/>\n  <input type=\"hidden\" name=\"${this.inputNamePrefix}[blocks][${id}][type]\" value=\"${type}\"/>\n  <input type=\"hidden\" name=\"${this.inputNamePrefix}[blocks][${id}][enabled]\" value=\"1\"/>\n  <div class=\"titlebar\">\n    <div class=\"blocktype\">${this.getBlockTypeByHandle(type).name}</div>\n    <div class=\"preview\"></div>\n  </div>\n  <div class=\"checkbox\" title=\"${Craft.t('app', 'Select')}\"></div>\n  <div class=\"actions\">\n    <div class=\"status off\" title=\"${Craft.t('app', 'Disabled')}\"></div>\n    <a class=\"settings icon menubtn\" title=\"${Craft.t('app', 'Actions')}\" role=\"button\"></a> \n    <div class=\"menu\">\n      <ul class=\"padded\">\n        <li><a data-icon=\"collapse\" data-action=\"collapse\">${Craft.t('app', 'Collapse')}</a></li>\n        <li class=\"hidden\"><a data-icon=\"expand\" data-action=\"expand\">${Craft.t('app', 'Expand')}</a></li>\n        <li><a data-icon=\"disabled\" data-action=\"disable\">${Craft.t('app', 'Disable')}</a></li>\n        <li class=\"hidden\"><a data-icon=\"enabled\" data-action=\"enable\">${Craft.t('app', 'Enable')}</a></li>\n      </ul>`;\n\n                if (!this.settings.staticBlocks) {\n                    html += `\n      <hr class=\"padded\"/>\n      <ul class=\"padded\">\n        <li><a class=\"error\" data-icon=\"remove\" data-action=\"delete\">${Craft.t('app', 'Delete')}</a></li>\n      </ul>\n      <hr class=\"padded\"/>\n      <ul class=\"padded\">`;\n\n                    for (var i = 0; i < this.blockTypes.length; i++) {\n                        var blockType = this.blockTypes[i];\n                        html += `\n        <li><a data-icon=\"plus\" data-action=\"add\" data-type=\"${blockType.handle}\">${Craft.t('app', 'Add {type} above', {type: blockType.name})}</a></li>`;\n                    }\n\n                    html += `\n      </ul>`\n                }\n\n                html += `\n    </div>\n    <a class=\"move icon\" title=\"${Craft.t('app', 'Reorder')}\" role=\"button\"></a>\n  </div>\n</div>`;\n\n                var $block = $(html);\n\n                if ($insertBefore) {\n                    $block.insertBefore($insertBefore);\n                }\n                else {\n                    $block.appendTo(this.$blockContainer);\n                }\n\n                var $fieldsContainer = $('<div class=\"fields\"/>').appendTo($block),\n                    bodyHtml = this.getParsedBlockHtml(this.blockTypesByHandle[type].bodyHtml, id),\n                    footHtml = this.getParsedBlockHtml(this.blockTypesByHandle[type].footHtml, id);\n\n                $(bodyHtml).appendTo($fieldsContainer);\n\n                this.trigger('blockAdded', {\n                    $block: $block\n                });\n\n                // Animate the block into position\n                $block.css(this.getHiddenBlockCss($block)).velocity({\n                    opacity: 1,\n                    'margin-bottom': 10\n                }, 'fast', $.proxy(function() {\n                    $block.css('margin-bottom', '');\n                    Garnish.$bod.append(footHtml);\n                    Craft.initUiElements($fieldsContainer);\n                    new MatrixBlock(this, $block);\n                    this.blockSort.addItems($block);\n                    this.blockSelect.addItems($block);\n                    this.updateAddBlockBtn();\n\n                    Garnish.requestAnimationFrame(function() {\n                        // Scroll to the block\n                        Garnish.scrollContainerToElement($block);\n\n                        // Focus on the first text input\n                        $block.find('.text,[contenteditable]').first().trigger('focus');\n                    });\n                }, this));\n            },\n\n            getBlockTypeByHandle: function(handle) {\n                for (var i = 0; i < this.blockTypes.length; i++) {\n                    if (this.blockTypes[i].handle === handle) {\n                        return this.blockTypes[i];\n                    }\n                }\n            },\n\n            collapseSelectedBlocks: function() {\n                this.callOnSelectedBlocks('collapse');\n            },\n\n            expandSelectedBlocks: function() {\n                this.callOnSelectedBlocks('expand');\n            },\n\n            disableSelectedBlocks: function() {\n                this.callOnSelectedBlocks('disable');\n            },\n\n            enableSelectedBlocks: function() {\n                this.callOnSelectedBlocks('enable');\n            },\n\n            deleteSelectedBlocks: function() {\n                this.callOnSelectedBlocks('selfDestruct');\n            },\n\n            callOnSelectedBlocks: function(fn) {\n                for (var i = 0; i < this.blockSelect.$selectedItems.length; i++) {\n                    this.blockSelect.$selectedItems.eq(i).data('block')[fn]();\n                }\n            },\n\n            getHiddenBlockCss: function($block) {\n                return {\n                    opacity: 0,\n                    marginBottom: -($block.outerHeight())\n                };\n            },\n\n            getParsedBlockHtml: function(html, id) {\n                if (typeof html === 'string') {\n                    return html.replace(/__BLOCK__/g, id);\n                }\n                else {\n                    return '';\n                }\n            },\n\n            get maxBlocks() {\n                return this.settings.maxBlocks;\n            },\n        },\n        {\n            defaults: {\n                maxBlocks: null,\n                staticBlocks: false,\n            },\n\n            collapsedBlockStorageKey: 'Craft-' + Craft.systemUid + '.MatrixInput.collapsedBlocks',\n\n            getCollapsedBlockIds: function() {\n                if (typeof localStorage[Craft.MatrixInput.collapsedBlockStorageKey] === 'string') {\n                    return Craft.filterArray(localStorage[Craft.MatrixInput.collapsedBlockStorageKey].split(','));\n                }\n                else {\n                    return [];\n                }\n            },\n\n            setCollapsedBlockIds: function(ids) {\n                localStorage[Craft.MatrixInput.collapsedBlockStorageKey] = ids.join(',');\n            },\n\n            rememberCollapsedBlockId: function(id) {\n                if (typeof Storage !== 'undefined') {\n                    var collapsedBlocks = Craft.MatrixInput.getCollapsedBlockIds();\n\n                    if ($.inArray('' + id, collapsedBlocks) === -1) {\n                        collapsedBlocks.push(id);\n                        Craft.MatrixInput.setCollapsedBlockIds(collapsedBlocks);\n                    }\n                }\n            },\n\n            forgetCollapsedBlockId: function(id) {\n                if (typeof Storage !== 'undefined') {\n                    var collapsedBlocks = Craft.MatrixInput.getCollapsedBlockIds(),\n                        collapsedBlocksIndex = $.inArray('' + id, collapsedBlocks);\n\n                    if (collapsedBlocksIndex !== -1) {\n                        collapsedBlocks.splice(collapsedBlocksIndex, 1);\n                        Craft.MatrixInput.setCollapsedBlockIds(collapsedBlocks);\n                    }\n                }\n            }\n        });\n\n\n    var MatrixBlock = Garnish.Base.extend(\n        {\n            matrix: null,\n            $container: null,\n            $titlebar: null,\n            $fieldsContainer: null,\n            $previewContainer: null,\n            $actionMenu: null,\n            $collapsedInput: null,\n\n            isNew: null,\n            id: null,\n\n            collapsed: false,\n\n            init: function(matrix, $container) {\n                this.matrix = matrix;\n                this.$container = $container;\n                this.$titlebar = $container.children('.titlebar');\n                this.$previewContainer = this.$titlebar.children('.preview');\n                this.$fieldsContainer = $container.children('.fields');\n\n                this.$container.data('block', this);\n\n                this.id = this.$container.data('id');\n                this.isNew = (!this.id || (typeof this.id === 'string' && this.id.substr(0, 3) === 'new'));\n\n                var $menuBtn = this.$container.find('> .actions > .settings'),\n                    menuBtn = new Garnish.MenuBtn($menuBtn);\n\n                this.$actionMenu = menuBtn.menu.$container;\n\n                menuBtn.menu.settings.onOptionSelect = $.proxy(this, 'onMenuOptionSelect');\n\n                menuBtn.menu.on('show', () => {\n                    this.$container.addClass('active');\n                });\n                menuBtn.menu.on('hide', () => {\n                    this.$container.removeClass('active');\n                });\n\n                // Was this block already collapsed?\n                if (Garnish.hasAttr(this.$container, 'data-collapsed')) {\n                    this.collapse();\n                }\n\n                this._handleTitleBarClick = function(ev) {\n                    ev.preventDefault();\n                    this.toggle();\n                };\n\n                this.addListener(this.$titlebar, 'doubletap', this._handleTitleBarClick);\n            },\n\n            toggle: function() {\n                if (this.collapsed) {\n                    this.expand();\n                }\n                else {\n                    this.collapse(true);\n                }\n            },\n\n            collapse: function(animate) {\n                if (this.collapsed) {\n                    return;\n                }\n\n                this.$container.addClass('collapsed');\n\n                var previewHtml = '',\n                    $fields = this.$fieldsContainer.children();\n\n                for (var i = 0; i < $fields.length; i++) {\n                    var $field = $($fields[i]),\n                        $inputs = $field.children('.input').find('select,input[type!=\"hidden\"],textarea,.label'),\n                        inputPreviewText = '';\n\n                    for (var j = 0; j < $inputs.length; j++) {\n                        var $input = $($inputs[j]),\n                            value;\n\n                        if ($input.hasClass('label')) {\n                            var $maybeLightswitchContainer = $input.parent().parent();\n\n                            if ($maybeLightswitchContainer.hasClass('lightswitch') && (\n                                    ($maybeLightswitchContainer.hasClass('on') && $input.hasClass('off')) ||\n                                    (!$maybeLightswitchContainer.hasClass('on') && $input.hasClass('on'))\n                                )) {\n                                continue;\n                            }\n\n                            value = $input.text();\n                        }\n                        else {\n                            value = Craft.getText(Garnish.getInputPostVal($input));\n                        }\n\n                        if (value instanceof Array) {\n                            value = value.join(', ');\n                        }\n\n                        if (value) {\n                            value = Craft.trim(value);\n\n                            if (value) {\n                                if (inputPreviewText) {\n                                    inputPreviewText += ', ';\n                                }\n\n                                inputPreviewText += value;\n                            }\n                        }\n                    }\n\n                    if (inputPreviewText) {\n                        previewHtml += (previewHtml ? ' <span>|</span> ' : '') + inputPreviewText;\n                    }\n                }\n\n                this.$previewContainer.html(previewHtml);\n\n                this.$fieldsContainer.velocity('stop');\n                this.$container.velocity('stop');\n\n                if (animate) {\n                    this.$fieldsContainer.velocity('fadeOut', {duration: 'fast'});\n                    this.$container.velocity({height: 16}, 'fast');\n                }\n                else {\n                    this.$previewContainer.show();\n                    this.$fieldsContainer.hide();\n                    this.$container.css({height: 16});\n                }\n\n                setTimeout($.proxy(function() {\n                    this.$actionMenu.find('a[data-action=collapse]:first').parent().addClass('hidden');\n                    this.$actionMenu.find('a[data-action=expand]:first').parent().removeClass('hidden');\n                }, this), 200);\n\n                // Remember that?\n                if (!this.isNew) {\n                    Craft.MatrixInput.rememberCollapsedBlockId(this.id);\n                }\n                else {\n                    if (!this.$collapsedInput) {\n                        this.$collapsedInput = $('<input type=\"hidden\" name=\"' + this.matrix.inputNamePrefix + '[blocks][' + this.id + '][collapsed]\" value=\"1\"/>').appendTo(this.$container);\n                    }\n                    else {\n                        this.$collapsedInput.val('1');\n                    }\n                }\n\n                this.collapsed = true;\n            },\n\n            expand: function() {\n                if (!this.collapsed) {\n                    return;\n                }\n\n                this.$container.removeClass('collapsed');\n\n                this.$fieldsContainer.velocity('stop');\n                this.$container.velocity('stop');\n\n                var collapsedContainerHeight = this.$container.height();\n                this.$container.height('auto');\n                this.$fieldsContainer.show();\n                var expandedContainerHeight = this.$container.height();\n                var displayValue = this.$fieldsContainer.css('display') || 'block';\n                this.$container.height(collapsedContainerHeight);\n                this.$fieldsContainer.hide().velocity('fadeIn', {duration: 'fast', display: displayValue});\n                this.$container.velocity({height: expandedContainerHeight}, 'fast', $.proxy(function() {\n                    this.$previewContainer.html('');\n                    this.$container.height('auto');\n                }, this));\n\n                setTimeout($.proxy(function() {\n                    this.$actionMenu.find('a[data-action=collapse]:first').parent().removeClass('hidden');\n                    this.$actionMenu.find('a[data-action=expand]:first').parent().addClass('hidden');\n                }, this), 200);\n\n                // Remember that?\n                if (!this.isNew && typeof Storage !== 'undefined') {\n                    var collapsedBlocks = Craft.MatrixInput.getCollapsedBlockIds(),\n                        collapsedBlocksIndex = $.inArray('' + this.id, collapsedBlocks);\n\n                    if (collapsedBlocksIndex !== -1) {\n                        collapsedBlocks.splice(collapsedBlocksIndex, 1);\n                        Craft.MatrixInput.setCollapsedBlockIds(collapsedBlocks);\n                    }\n                }\n\n                if (!this.isNew) {\n                    Craft.MatrixInput.forgetCollapsedBlockId(this.id);\n                }\n                else if (this.$collapsedInput) {\n                    this.$collapsedInput.val('');\n                }\n\n                this.collapsed = false;\n            },\n\n            disable: function() {\n                this.$container.children('input[name$=\"[enabled]\"]:first').val('');\n                this.$container.addClass('disabled');\n\n                setTimeout($.proxy(function() {\n                    this.$actionMenu.find('a[data-action=disable]:first').parent().addClass('hidden');\n                    this.$actionMenu.find('a[data-action=enable]:first').parent().removeClass('hidden');\n                }, this), 200);\n\n                this.collapse(true);\n            },\n\n            enable: function() {\n                this.$container.children('input[name$=\"[enabled]\"]:first').val('1');\n                this.$container.removeClass('disabled');\n\n                setTimeout($.proxy(function() {\n                    this.$actionMenu.find('a[data-action=disable]:first').parent().removeClass('hidden');\n                    this.$actionMenu.find('a[data-action=enable]:first').parent().addClass('hidden');\n                }, this), 200);\n            },\n\n            onMenuOptionSelect: function(option) {\n                var batchAction = (this.matrix.blockSelect.totalSelected > 1 && this.matrix.blockSelect.isSelected(this.$container)),\n                    $option = $(option);\n\n                switch ($option.data('action')) {\n                    case 'collapse': {\n                        if (batchAction) {\n                            this.matrix.collapseSelectedBlocks();\n                        }\n                        else {\n                            this.collapse(true);\n                        }\n\n                        break;\n                    }\n\n                    case 'expand': {\n                        if (batchAction) {\n                            this.matrix.expandSelectedBlocks();\n                        }\n                        else {\n                            this.expand();\n                        }\n\n                        break;\n                    }\n\n                    case 'disable': {\n                        if (batchAction) {\n                            this.matrix.disableSelectedBlocks();\n                        }\n                        else {\n                            this.disable();\n                        }\n\n                        break;\n                    }\n\n                    case 'enable': {\n                        if (batchAction) {\n                            this.matrix.enableSelectedBlocks();\n                        }\n                        else {\n                            this.enable();\n                            this.expand();\n                        }\n\n                        break;\n                    }\n\n                    case 'add': {\n                        var type = $option.data('type');\n                        this.matrix.addBlock(type, this.$container);\n                        break;\n                    }\n\n                    case 'delete': {\n                        if (batchAction) {\n                            if (confirm(Craft.t('app', 'Are you sure you want to delete the selected blocks?'))) {\n                                this.matrix.deleteSelectedBlocks();\n                            }\n                        }\n                        else {\n                            this.selfDestruct();\n                        }\n\n                        break;\n                    }\n                }\n            },\n\n            selfDestruct: function() {\n                this.$container.velocity(this.matrix.getHiddenBlockCss(this.$container), 'fast', $.proxy(function() {\n                    this.$container.remove();\n                    this.matrix.updateAddBlockBtn();\n\n                    if (window.draftEditor) {\n                        window.draftEditor.checkForm();\n                    }\n                }, this));\n\n                this.matrix.trigger('blockDeleted', {\n                    $block: this.$container,\n                });\n            }\n        });\n})(jQuery);\n"]}