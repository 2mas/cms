# Running Release Notes for Craft CMS 3.5

> {warning} If you have the `baseCpUrl` config setting set, Craft 3.5 will **only** allow the control panel to be accessed from that URL.

### Added
- Added the “Show rounded icons” user preference. ([#5518](https://github.com/craftcms/cms/issues/5518))
- Added the “Use shapes to represent statuses” user preference. ([#3293](https://github.com/craftcms/cms/issues/3293))
- Added the “Suspend by default” user registration setting. ([#5830](https://github.com/craftcms/cms/issues/5830))
- Added the ability to disable sites on the front end. ([#3005](https://github.com/craftcms/cms/issues/3005))
- Soft-deleted elements now have a “Delete permanently” element action. ([#4420](https://github.com/craftcms/cms/issues/4420))
- Assets now have a “Copy URL” element action. ([#2944](https://github.com/craftcms/cms/issues/2944))
- Entry indexes can now show “Revision Notes” and “Last Edited By” columns. ([#5907](https://github.com/craftcms/cms/issues/5907))
- Sections now have a new Propagation Method option, which gives entries control over which sites they should be saved to. ([#5988](https://github.com/craftcms/cms/issues/5988))
- It’s now possible to set a custom route that handles Set Password requests. ([#5722](https://github.com/craftcms/cms/issues/5722))
- Field labels now reveal their handles when the <kbd>Option</kbd>/<kbd>ALT</kbd> key is pressed. ([#5833](https://github.com/craftcms/cms/issues/5833))
- Added the `allowedGraphqlOrigins` config setting. ([#5933](https://github.com/craftcms/cms/issues/5933))
- Added the `brokenImagePath` config setting. ([#5877](https://github.com/craftcms/cms/issues/5877))
- Added the `cpHeadTags` config setting, making it possible to give the control panel a custom favicon. ([#4003](https://github.com/craftcms/cms/issues/4003))
- Added the `siteToken` config setting.
- Added the `install/check` command. ([#5810](https://github.com/craftcms/cms/issues/5810))
- Added the `plugin/install`, `plugin/uninstall`, `plugin/enable`, and `plugin/disable` commands. ([#5817](https://github.com/craftcms/cms/issues/5817))
- Added the `{% html %}` Twig tag, which makes it possible to register arbitrary HTML for inclusion in the `<head>`, beginning of `<body>`, or end of `<body>`. ([#5955](https://github.com/craftcms/cms/issues/5955))
- Added the `|diff` Twig filter.
- Added the `|explodeClass` Twig filter, which converts class names into an array.
- Added the `|explodeStyle` Twig filter, which converts CSS styles into an array of property/value pairs.
- Added the `|push` Twig filter, which returns a new array with one or more items appended to it.
- Added the `|unshift` Twig filter, which returns a new array with one or more items prepended to it.
- Added the `|where` Twig filter.
- Added the `raw()` Twig function, which wraps the given string in a `Twig\Markup` object to prevent it from getting HTML-encoded.
- Added support for eager-loading elements’ current revisions, via `currentRevision`.
- Added support for eager-loading drafts’ and revisions’ creators, via `draftCreator` and `revisionCreator`.
- Added support for the `CRAFT_CP` PHP constant. ([#5122](https://github.com/craftcms/cms/issues/5122))
- Added support for [GraphQL mutations](https://docs.craftcms.com/v3/graphql.html#mutations). ([#4835](https://github.com/craftcms/cms/issues/4835))
- Added the `drafts`, `draftOf`, `draftId`, `draftCreator`, `revisions`, `revisionOf`, `revisionId` and `revisionCreator` arguments to element queries using GraphQL API. ([#5580](https://github.com/craftcms/cms/issues/5580))
- Added the `isDraft`, `isRevision`, `sourceId`, `sourceUid`, and `isUnsavedDraft` fields to elements when using GraphPQL API. ([#5580](https://github.com/craftcms/cms/issues/5580))
- Added the `assetCount`, `categoryCount`, `entryCount`, `tagCount`, and `userCount` queries for fetching the element counts to the GraphPQL API. ([#4847](https://github.com/craftcms/cms/issues/4847))
- Added the `locale` argument to the `formatDateTime` GraphQL directive. ([#5593](https://github.com/craftcms/cms/issues/5593))
- Added support for specifying a transform on assets’ `width` and `height` fields via GraphQL.
- Added `craft\base\ConfigurableComponent`.
- Added `craft\base\ConfigurableComponentInterface`.
- Added `craft\base\Element::EVENT_DEFINE_KEYWORDS`. ([#6028](https://github.com/craftcms/cms/issues/6028))
- Added `craft\base\Element::EVENT_SET_EAGER_LOADED_ELEMENTS`.
- Added `craft\base\Element::searchKeywords()`.
- Added `craft\base\ElementInterface::getIconUrl()`.
- Added `craft\base\ElementInterface::gqlMutationNameByContext()`.
- Added `craft\base\ElementTrait::$elementSiteId`.
- Added `craft\base\Field::EVENT_DEFINE_KEYWORDS`. ([#6028](https://github.com/craftcms/cms/issues/6028))
- Added `craft\base\Field::searchKeywords()`.
- Added `craft\base\FieldInterface::getContentGqlMutationArgumentType()`.
- Added `craft\base\FieldInterface::getContentGqlQueryArgumentType()`.
- Added `craft\behaviors\BaseRevisionBehavior`.
- Added `craft\config\GeneralConfig::getTestToEmailAddress()`.
- Added `craft\console\controllers\MailerController::$to`.
- Added `craft\controllers\AppController::actionBrokenImage()`.
- Added `craft\controllers\BaseEntriesController::enforceSitePermissions()`.
- Added `craft\elements\actions\CopyUrl`.
- Added `craft\elements\actions\Delete::$hard`.
- Added `craft\elements\Asset::getSrcset()`. ([#5774](https://github.com/craftcms/cms/issues/5774))
- Added `craft\events\DefineAttributeKeywordsEvent`.
- Added `craft\events\DefineFieldKeywordsEvent`.
- Added `craft\events\RegisterGqlMutationsEvent`.
- Added `craft\events\RegisterGqlSchemaComponentsEvent`.
- Added `craft\events\SetEagerLoadedElementsEvent`.
- Added `craft\gql\arguments\mutations\Asset`.
- Added `craft\gql\arguments\mutations\Draft`.
- Added `craft\gql\arguments\mutations\Entry`.
- Added `craft\gql\arguments\mutations\Structure`.
- Added `craft\gql\base\ElementMutationArguments`.
- Added `craft\gql\base\ElementMutationResolver`.
- Added `craft\gql\base\MutationArguments`.
- Added `craft\gql\base\MutationResolver`.
- Added `craft\gql\base\SingleGeneratorInterface`.
- Added `craft\gql\base\StructureMutationTrait`.
- Added `craft\gql\ElementQueryConditionBuilder`.
- Added `craft\gql\Mutation`.
- Added `craft\gql\mutations\Category`.
- Added `craft\gql\mutations\Entry`.
- Added `craft\gql\mutations\GlobalSet`.
- Added `craft\gql\mutations\Ping`.
- Added `craft\gql\mutations\Tag`.
- Added `craft\gql\resolvers\mutations\Asset`.
- Added `craft\gql\resolvers\mutations\Category`.
- Added `craft\gql\resolvers\mutations\Entry`.
- Added `craft\gql\resolvers\mutations\GlobalSet`.
- Added `craft\gql\resolvers\mutations\Tag`.
- Added `craft\gql\types\input\File`.
- Added `craft\gql\types\input\Matrix`.
- Added `craft\gql\types\Mutation`.
- Added `craft\gql\types\TableRow::prepareRowFieldDefinition()`.
- Added `craft\helpers\Assets::parseSrcsetSize()`.
- Added `craft\helpers\Assets::scaledDimensions()`.
- Added `craft\helpers\Console::ensureProjectConfigFileExists()`.
- Added `craft\helpers\Db::batchInsert()`.
- Added `craft\helpers\Db::delete()`.
- Added `craft\helpers\Db::insert()`.
- Added `craft\helpers\Db::replace()`.
- Added `craft\helpers\Db::update()`.
- Added `craft\helpers\Db::upsert()`.
- Added `craft\helpers\Gql::canMutateAssets()`.
- Added `craft\helpers\Gql::canMutateCategories()`.
- Added `craft\helpers\Gql::canMutateEntries()`.
- Added `craft\helpers\Gql::canMutateGlobalSets()`.
- Added `craft\helpers\Gql::canMutateTags()`.
- Added `craft\helpers\Gql::extractEntityAllowedActions()`.
- Added `craft\helpers\FileHelper::addFilesToZip()`.
- Added `craft\helpers\FileHelper::zip()`.
- Added `craft\helpers\Html::explodeClass()`.
- Added `craft\helpers\Html::explodeStyle()`.
- Added `craft\helpers\Html::id()`.
- Added `craft\helpers\Html::namespaceAttributes()`.
- Added `craft\helpers\Html::namespaceHtml()`.
- Added `craft\helpers\Html::namespaceId()`.
- Added `craft\helpers\Html::namespaceInputName()`.
- Added `craft\helpers\Html::namespaceInputs()`.
- Added `craft\helpers\MailerHelper::normalizeEmails()`.
- Added `craft\helpers\MailerHelper::settingsReport()`.
- Added `craft\helpers\Queue`.
- Added `craft\models\Section::PROPAGATION_METHOD_CUSTOM`.
- Added `craft\models\Site::$enabled`.
- Added `craft\services\AssetTransforms::extendTransform()`. ([#5853](https://github.com/craftcms/cms/issues/5853))
- Added `craft\services\Composer::handleError()`.
- Added `craft\services\Composer::run()`.
- Added `craft\services\Elements::createElementQuery()`.
- Added `craft\services\Gql::getAllSchemaComponents()`.
- Added `craft\services\Images::getSupportsWebP()`. ([#5853](https://github.com/craftcms/cms/issues/5853))
- Added `craft\services\ProjectConfig::$filename`. ([#5982](https://github.com/craftcms/cms/issues/5982))
- Added `craft\queue\jobs\PruneRevisions`.
- Added `craft\test\mockclasses\elements\MockElementQuery`.
- Added `craft\web\AssetBundle\ContentWindowAsset`.
- Added `craft\web\AssetBundle\IframeResizerAsset`.
- Added `craft\web\Request::getAcceptsImage()`.
- Added `craft\web\Request::getFullUri()`.
- Added the `_includes/forms/password.html` control panel template.
- Added the `_includes/forms/copytext.html` control panel template.
- Added the `copytext` and `copytextField` macros to the `_includes/forms.html` control panel template.
- Added the `Craft.ui.createCopyTextInput()`, `createCopyTextField()`, and `createCopyTextPrompt()` JavaScript methods.
- Added the [iFrame Resizer](http://davidjbradshaw.github.io/iframe-resizer/) library.
- Craft will now regenerate missing transforms on local Volumes. ([#5956](https://github.com/craftcms/cms/issues/5956))

### Changed
- User registration forms in the control panel now give users the option to send an activation email, even if email verification isn’t required. ([#5836](https://github.com/craftcms/cms/issues/5836))
- Activation emails are now sent automatically on public registration if the `deferPublicRegistrationPassword` config setting is enabled, even if email verification isn’t required. ([#5836](https://github.com/craftcms/cms/issues/5836))
- Large asset thumbnails now use the same aspect ratio as the source image. ([#5515](https://github.com/craftcms/cms/issues/5515))
- Preview frames now maintain their scroll position across refreshes, even for cross-origin preview targets.
- Preview targets that aren’t directly rendered by Craft must now include `lib/iframe-resizer-cw/iframeResizer.contentWindow.js` in order to maintain scroll position across refreshes.
- The preview frame header no longer hides the top 54px of the preview frame when it’s scrolled all the way to the top. ([#5547](https://github.com/craftcms/cms/issues/5547))
- Modal backdrops no longer blur the page content. ([#5651](https://github.com/craftcms/cms/issues/5651))
- Element editor HUDs now warn before switching to another site, if there are any unsaved content changes. ([#2512](https://github.com/craftcms/cms/issues/2512))
- Improved the styling of password inputs in the control panel.
- Improved the UI for copying user activation URLs, asset reference tags, and GraphQL tokens’ authentication headers.
- Improved the wording of the meta info displayed in entry revision menus. ([#5889](https://github.com/craftcms/cms/issues/5889))
- Plain Text fields are now sortable in the control panel. ([#5819](https://github.com/craftcms/cms/issues/5819))
- Extra entry revisions (per the `maxRevisions` config setting) are now pruned via a background job. ([#5902](https://github.com/craftcms/cms/issues/5902))
- Database backups created by the Database Backup utility are now saved as zip files. ([#5822](https://github.com/craftcms/cms/issues/5822))
- It’s now possible to specify aliases when eager-loading elements via the `with` param. ([#5793](https://github.com/craftcms/cms/issues/5793))
- It’s now possible to eager-load elements’ ancestors and parents. ([#1382](https://github.com/craftcms/cms/issues/1382))
- The `cpTrigger` config setting can now be set to `null`. ([#5122](https://github.com/craftcms/cms/issues/5122))
- The `pathParam` config setting can now be set to `null`. ([#5676](https://github.com/craftcms/cms/issues/5676))
- If the `baseCpUrl` config setting is set, Craft will no longer treat any other base URLs as control panel requests, even if they contain the correct trigger segment. ([#5860](https://github.com/craftcms/cms/issues/5860))
- The `mailer/test` command now only supports testing the current email settings.
- Reference tags can now provide a fallback value to be used if the reference can’t be resolved. ([#5589](https://github.com/craftcms/cms/issues/5589))
- It’s no longer necessary to append the `|raw` filter after the `|namespace` filter.
- The `|namespace` Twig filter now namespaces ID selectors within `<style>` tags. ([#5921](https://github.com/craftcms/cms/issues/5921))
- The `|namespace` Twig filter now has a `withClasses` argument, which if set to `true` causes `class` attributes and class name CSS selectors within `<style>` tags to be namespaced. ([#5921](https://github.com/craftcms/cms/issues/5921))
- The `{% namespace %}` Twig tag can now have a `withClasses` flag, which causes `class` attributes and class name CSS selectors within `<style>` tags to be namespaced. ([#5921](https://github.com/craftcms/cms/issues/5921))
- Element queries’ `siteId` params can now be set to an array that begins with `'not'` to exclude specific site IDs.
- The `withTransforms` asset query param can now include `srcset`-style sizes (e.g. `100w` or `2x`), following a normal transform definition.
- The `QueryArgument` GraphQL type now also allows boolean values.
- Improved transform eager-loading support when using GraphQL API.
- It’s now possible to register template roots without a template prefix. ([#6015](https://github.com/craftcms/cms/issues/6015))
- It’s now possible to register multiple directories per template root. ([#6015](https://github.com/craftcms/cms/issues/6015))
- Lightswitch inputs can now have labels, like checkboxes.
- `craft\base\Element::getRoute()` now returns the route defined by `craft\events\SetElementRouteEvent::$route` even if it’s null, as long as `SetElementRouteEvent::$handled` is set to `true`.
- `craft\db\ActiveRecord` now unsets any empty primary key values when saving new records, to avoid a SQL error on PostgreSQL. ([#5814](https://github.com/craftcms/cms/pull/5814))
- `craft\elements\Asset::getImg()` now has a `$sizes` argument. ([#5774](https://github.com/craftcms/cms/issues/5774))
- `craft\helpers\ElementHelper::supportedSitesForElement()` now has a `$withUnpropagatedSites` argument.
- `craft\helpers\StringHelper::randomString()` no longer includes capital letters or numbers by default.
- `craft\i18n\Formatter::asTimestamp()` now has a `$withPreposition` argument.
- `craft\services\Gql` now fires a `registerGqlMutations` event that allows for plugins to register their own GraphQL mutations.
- `craft\services\Sites::getAllSiteIds()`, `getSiteByUid()`, `getAllSites()`, `getSitesByGroupId()`, `getSiteById()`, and `getSiteByHandle()` now have `$withDisabled` arguments.
- Improved `data`/`aria` tag normalization via `craft\helpers\Html::parseTagAttributes()` and `normalizeTagAttributes()`.
- Control panel form input macros and templates that accept a `class` variable can now pass it as an array of class names.
- Updated Composer to 1.10.5. ([#5925](https://github.com/craftcms/cms/pull/5925))
- Updated voku/stringy to ^6.2.2. ([#5989](https://github.com/craftcms/cms/issues/5989))
- `craft\elements\Asset::getUrl()` now has a `$transformOverrideParameters` parameter. ([#5853](https://github.com/craftcms/cms/issues/5853))

### Deprecated
- Deprecated the `install/plugin` command. `plugin/install` should be used instead.
- Deprecated the `|filterByValue` Twig filter. `|where` should be used instead.
- Deprecated the `|ucwords` Twig filter. `|title` should be used instead.
- Deprecated `craft\gql\base\Resolver::extractEagerLoadCondition()`. `ElementQueryConditionBuilder` should be used instead.
- Deprecated `craft\helpers\Stringy`.
- Deprecated `craft\web\View::formatInputId()`. `craft\helpers\Html::namespaceHtml()` should be used instead.
- Deprecated `craft\events\RegisterGqlPermissionsEvent`. `craft\events\RegisterGqlSchemaComponentsEvent` should be used instead.
- Deprecated `craft\services\Gql::getAllPermissions()`. `craft\services\Gql::getAllSchemaComponents()` should be used instead.
- Deprecated `craft\services\ProjectConfig::CONFIG_FILENAME`. `$filename` should be used instead.

### Removed
- Removed the [Interactive Shell Extension for Yii 2](https://github.com/yiisoft/yii2-shell), as it’s now a dev dependency of the `craftcms/craft` project instead. ([#5783](https://github.com/craftcms/cms/issues/5783))
- Removed `craft\controllers\UtilitiesController::actionDbBackupPerformAction()`.

### Fixed
- Fixed a bug where the `mailer/test` command wasn’t factoring in custom `mailer` configurations in its settings report. ([#5763](https://github.com/craftcms/cms/issues/5763))
- Fixed a bug where some characters were getting double-encoded in Assets fields’ “Default Upload Location”/“Upload Location” setting. ([#5885](https://github.com/craftcms/cms/issues/5885))
- Fixed a bug where the `svg()` Twig function wasn’t namespacing ID and class name CSS selectors that didn’t have any matching `id`/`class` attribute values. ([#5922](https://github.com/craftcms/cms/issues/5922))
- Fixed a bug where `users/set-password` and `users/verify-email` requests weren’t responding with JSON when requested, if an invalid verification code was passed. ([#5210](https://github.com/craftcms/cms/issues/5210))
- Fixed a bug where it was impossible to filter elements using a Lightswitch field using the GraphQL API. ([#5930](https://github.com/craftcms/cms/issues/5930))

### Security
- The `_includes/forms/checkbox.html`, `checkboxGroup.html`, and `checkboxSelect.html` control panel templates now HTML-encode checkbox labels by default, preventing possible XSS vulnerabilities. If HTML code was desired, it must be passed through the new `raw()` function first.
